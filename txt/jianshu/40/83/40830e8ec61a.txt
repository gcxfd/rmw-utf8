iOS åŠ¨ç”»
åœ¨iOSå®é™…å¼€å‘ä¸­å¸¸ç”¨çš„åŠ¨ç”»æ— éæ˜¯ä»¥ä¸‹å››ç§ï¼šUIViewåŠ¨ç”»ï¼Œæ ¸å¿ƒåŠ¨ç”»ï¼Œå¸§åŠ¨ç”»ï¼Œè‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ã€‚
èƒ½å®ç°UIViewåŠ¨ç”»çš„å±æ€§
UIViewåŠ¨ç”»æ˜¯iOSå¼€å‘ä¸­æœ€å»‰ä»·ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„åŠ¨ç”»ã€‚UIViewåŠ¨ç”»èƒ½å¤Ÿè®¾ç½®çš„åŠ¨ç”»å±æ€§æœ‰ï¼š
frame
bounds
center
transform
alpha
backgroundColor
contentStretch
UIViewåŠ¨ç”»å®ç°æ–¹å¼æœ‰æ™®é€šæ–¹å¼å’ŒBlockæ–¹å¼ï¼Œä¸è¿‡å¹³å¸¸æˆ‘ä»¬ä¸€èˆ¬ä¼šç›´æ¥ä½¿ç”¨Blockçš„æ–¹å¼ã€‚ç®€å•ï¼Œç²—æš´ï¼Œç®¡ç”¨ï¼
å…ˆè¯´è¯´æ™®é€šæ–¹å¼å®ç°åŠ¨ç”»ã€‚
å¼€å§‹åŠ¨ç”»è¯­å¥ï¼š
// ç¬¬ä¸€ä¸ªå‚æ•°: åŠ¨ç”»æ ‡è¯†
// ç¬¬äºŒä¸ªå‚æ•°: é™„åŠ å‚æ•°,åœ¨è®¾ç½®ä»£ç†æƒ…å†µä¸‹ï¼Œæ­¤å‚æ•°å°†å‘é€åˆ°setAnimationWillStartSelectorå’ŒsetAnimationDidStopSelectoræ‰€æŒ‡å®šçš„æ–¹æ³•ï¼Œå¤§éƒ¨åˆ†æƒ…å†µï¼Œè®¾ç½®ä¸ºnil.
[UIView beginAnimations:(nullable NSString *) context:(nullable void *)];
ç»“æŸåŠ¨ç”»è¯­å¥ï¼š
[UIView commitAnimations];
åŠ¨ç”»å‚æ•°çš„å±æ€§è®¾ç½®:
//åŠ¨ç”»æŒç»­æ—¶é—´
[UIView setAnimationDuration:(NSTimeInterval)];
//åŠ¨ç”»çš„ä»£ç†å¯¹è±¡
[UIView setAnimationDelegate:(nullable id)];
//è®¾ç½®åŠ¨ç”»å°†å¼€å§‹æ—¶ä»£ç†å¯¹è±¡æ‰§è¡Œçš„SEL
[UIView setAnimationWillStartSelector:(nullable SEL)];
//è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´
[UIView setAnimationDelay:(NSTimeInterval)];
//è®¾ç½®åŠ¨ç”»çš„é‡å¤æ¬¡æ•°
[UIView setAnimationRepeatCount:(float)];
//è®¾ç½®åŠ¨ç”»çš„æ›²çº¿
/*
UIViewAnimationCurveçš„æšä¸¾å€¼ï¼š
UIViewAnimationCurveEaseInOut,Â  Â  Â  Â   // æ…¢è¿›æ…¢å‡ºï¼ˆé»˜è®¤å€¼ï¼‰
UIViewAnimationCurveEaseIn,Â  Â  Â  Â  Â  Â  // æ…¢è¿›
UIViewAnimationCurveEaseOut,Â  Â  Â  Â  Â   // æ…¢å‡º
UIViewAnimationCurveLinearÂ  Â  Â  Â  Â  Â   // åŒ€é€Ÿ
*/
[UIView setAnimationCurve:(UIViewAnimationCurve)];
//è®¾ç½®æ˜¯å¦ä»å½“å‰çŠ¶æ€å¼€å§‹æ’­æ”¾åŠ¨ç”»
/*å‡è®¾ä¸Šä¸€ä¸ªåŠ¨ç”»æ­£åœ¨æ’­æ”¾ï¼Œä¸”å°šæœªæ’­æ”¾å®Œæ¯•ï¼Œæˆ‘ä»¬å°†è¦è¿›è¡Œä¸€ä¸ªæ–°çš„åŠ¨ç”»ï¼š
å½“ä¸ºYESæ—¶ï¼šåŠ¨ç”»å°†ä»ä¸Šä¸€ä¸ªåŠ¨ç”»æ‰€åœ¨çš„çŠ¶æ€å¼€å§‹æ’­æ”¾
å½“ä¸ºNOæ—¶ï¼šåŠ¨ç”»å°†ä»ä¸Šä¸€ä¸ªåŠ¨ç”»æ‰€æŒ‡å®šçš„æœ€ç»ˆçŠ¶æ€å¼€å§‹æ’­æ”¾ï¼ˆæ­¤æ—¶ä¸Šä¸€ä¸ªåŠ¨ç”»é©¬ä¸Šç»“æŸï¼‰*/
[UIView setAnimationBeginsFromCurrentState:YES];
//è®¾ç½®åŠ¨ç”»æ˜¯å¦ç»§ç»­æ‰§è¡Œç›¸åçš„åŠ¨ç”»
[UIView setAnimationRepeatAutoreverses:(BOOL)];
//æ˜¯å¦ç¦ç”¨åŠ¨ç”»æ•ˆæœï¼ˆå¯¹è±¡å±æ€§ä¾ç„¶ä¼šè¢«æ”¹å˜ï¼Œåªæ˜¯æ²¡æœ‰åŠ¨ç”»æ•ˆæœï¼‰
[UIView setAnimationsEnabled:(BOOL)];
//è®¾ç½®è§†å›¾çš„è¿‡æ¸¡æ•ˆæœ
/* ç¬¬ä¸€ä¸ªå‚æ•°ï¼šUIViewAnimationTransitionçš„æšä¸¾å€¼å¦‚ä¸‹
UIViewAnimationTransitionNone,Â  Â  Â  Â  Â  Â  Â  //ä¸ä½¿ç”¨åŠ¨ç”»
UIViewAnimationTransitionFlipFromLeft,Â  Â  Â  //ä»å·¦å‘å³æ—‹è½¬ç¿»é¡µ
UIViewAnimationTransitionFlipFromRight,Â  Â   //ä»å³å‘å·¦æ—‹è½¬ç¿»é¡µ
UIViewAnimationTransitionCurlUp,Â  Â  Â  Â  Â  Â  //ä»ä¸‹å¾€ä¸Šå·æ›²ç¿»é¡µ
UIViewAnimationTransitionCurlDown,Â  Â  Â  Â  Â  //ä»ä¸Šå¾€ä¸‹å·æ›²ç¿»é¡µ
ç¬¬äºŒä¸ªå‚æ•°ï¼šéœ€è¦è¿‡æ¸¡æ•ˆæœçš„View
ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæ˜¯å¦ä½¿ç”¨è§†å›¾ç¼“å­˜ï¼ŒYESï¼šè§†å›¾åœ¨å¼€å§‹å’Œç»“æŸæ—¶æ¸²æŸ“ä¸€æ¬¡ï¼›NOï¼šè§†å›¾åœ¨æ¯ä¸€å¸§éƒ½æ¸²æŸ“*/
[UIView setAnimationTransition:(UIViewAnimationTransition) forView:(nonnull UIView *) cache:(BOOL)];
ä¸‹é¢åˆ—å‡ºä¸‰ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
UITouch *tuch = touches.anyObject;
CGPoint point = [tuch locationInView:self.view];
[UIView beginAnimations:@"testAnimation" context:nil];
[UIView setAnimationDuration:3.0];
[UIView setAnimationDelegate:self];
//è®¾ç½®åŠ¨ç”»å°†å¼€å§‹æ—¶ä»£ç†å¯¹è±¡æ‰§è¡Œçš„SEL
[UIView setAnimationWillStartSelector:@selector(animationDoing)];
//è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´
[UIView setAnimationDelay:0];
[UIView setAnimationRepeatCount:MAXFLOAT];
[UIView setAnimationCurve:UIViewAnimationCurveLinear];
//è®¾ç½®åŠ¨ç”»æ˜¯å¦ç»§ç»­æ‰§è¡Œç›¸åçš„åŠ¨ç”»
[UIView setAnimationRepeatAutoreverses:YES];
self.redView.center = point;
self.redView.transform = CGAffineTransformMakeScale(1.5, 1.5);
self.redView.transform = CGAffineTransformMakeRotation(M_PI);
[UIView commitAnimations];
}
ä»£ç å¦‚ä¸‹ï¼š
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
// è½¬æˆåŠ¨ç”» (flip)
[UIView beginAnimations:@"imageViewTranslation" context:nil];
[UIView setAnimationDuration:2.0];
[UIView setAnimationDelegate:self];
[UIView setAnimationWillStartSelector:@selector(startAnimation)];
[UIView setAnimationDidStopSelector:@selector(stopAnimation)];
[UIView setAnimationRepeatCount:1.0];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
[UIView setAnimationRepeatAutoreverses:YES];
[UIView setAnimationRepeatCount:MAXFLOAT];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft forView:self.imageView cache:YES];
if (++count % 2 ==0) {
self.imageView.image = [UIImage imageNamed:@"yh_detial_ty"];
}else{
self.imageView.image = [UIImage imageNamed:@"yh_detial_bz"];
}
[UIView commitAnimations];
}
ä»£ç å¦‚ä¸‹ï¼š
[UIView beginAnimations:@"test" context:nil];
[UIView setAnimationDuration:1.0];
[UIView setAnimationRepeatCount:MAXFLOAT];
[UIView setAnimationTransition:UIViewAnimationTransitionCurlUp forView:self.redView cache:YES];
[UIView commitAnimations];
UIView Block åŠ¨ç”»
ios4.0ä»¥åå¢åŠ äº†BlockåŠ¨ç”»å—ï¼Œæä¾›äº†æ›´ç®€æ´çš„æ–¹å¼æ¥å®ç°åŠ¨ç”».æ—¥å¸¸å¼€å‘ä¸­ä¸€èˆ¬ä¹Ÿæ˜¯ä½¿ç”¨Blockå½¢å¼åˆ›å»ºåŠ¨ç”»ã€‚æœ€ç®€æ´çš„BlockåŠ¨ç”»:åŒ…å«æ—¶é—´å’ŒåŠ¨ç”»ï¼š
[UIView animateWithDuration:(NSTimeInterval)Â  //åŠ¨ç”»æŒç»­æ—¶é—´
animations:^{
//æ‰§è¡Œçš„åŠ¨ç”»
}];
å¸¦æœ‰åŠ¨ç”»æäº¤å›è°ƒçš„BlockåŠ¨ç”»
[UIView animateWithDuration:(NSTimeInterval)Â  //åŠ¨ç”»æŒç»­æ—¶é—´
animations:^{
//æ‰§è¡Œçš„åŠ¨ç”»
}Â  Â  Â  Â  Â  Â  Â  Â  completion:^(BOOL finished) {
//åŠ¨ç”»æ‰§è¡Œæäº¤åçš„æ“ä½œ
}];
å¯ä»¥è®¾ç½®å»¶æ—¶æ—¶é—´å’Œè¿‡æ¸¡æ•ˆæœçš„BlockåŠ¨ç”»
[UIView animateWithDuration:(NSTimeInterval) //åŠ¨ç”»æŒç»­æ—¶é—´
delay:(NSTimeInterval) //åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´
options:(UIViewAnimationOptions) //åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœ
animations:^{
//æ‰§è¡Œçš„åŠ¨ç”»
}Â  Â  Â  Â  Â  Â  Â  Â  completion:^(BOOL finished) {
//åŠ¨ç”»æ‰§è¡Œæäº¤åçš„æ“ä½œ
}];
UIViewAnimationOptionsçš„æšä¸¾å€¼å¦‚ä¸‹,å¯ç»„åˆä½¿ç”¨:
UIViewAnimationOptionLayoutSubviewsÂ  Â  Â  Â  Â  Â  //è¿›è¡ŒåŠ¨ç”»æ—¶å¸ƒå±€å­æ§ä»¶
UIViewAnimationOptionAllowUserInteractionÂ  Â  Â  //è¿›è¡ŒåŠ¨ç”»æ—¶å…è®¸ç”¨æˆ·äº¤äº’
UIViewAnimationOptionBeginFromCurrentStateÂ  Â   //ä»å½“å‰çŠ¶æ€å¼€å§‹åŠ¨ç”»
UIViewAnimationOptionRepeatÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  //æ— é™é‡å¤æ‰§è¡ŒåŠ¨ç”»
UIViewAnimationOptionAutoreverseÂ  Â  Â  Â  Â  Â  Â   //æ‰§è¡ŒåŠ¨ç”»å›è·¯
UIViewAnimationOptionOverrideInheritedDuration //å¿½ç•¥åµŒå¥—åŠ¨ç”»çš„æ‰§è¡Œæ—¶é—´è®¾ç½®
UIViewAnimationOptionOverrideInheritedCurveÂ  Â  //å¿½ç•¥åµŒå¥—åŠ¨ç”»çš„æ›²çº¿è®¾ç½®
UIViewAnimationOptionAllowAnimatedContentÂ  Â  Â  //è½¬åœºï¼šè¿›è¡ŒåŠ¨ç”»æ—¶é‡ç»˜è§†å›¾
UIViewAnimationOptionShowHideTransitionViewsÂ   //è½¬åœºï¼šç§»é™¤ï¼ˆæ·»åŠ å’Œç§»é™¤å›¾å±‚çš„ï¼‰åŠ¨ç”»æ•ˆæœ
UIViewAnimationOptionOverrideInheritedOptionsÂ  //ä¸ç»§æ‰¿çˆ¶åŠ¨ç”»è®¾ç½®
UIViewAnimationOptionCurveEaseInOutÂ  Â  Â  Â  Â  Â  //æ—¶é—´æ›²çº¿ï¼Œæ…¢è¿›æ…¢å‡ºï¼ˆé»˜è®¤å€¼ï¼‰
UIViewAnimationOptionCurveEaseInÂ  Â  Â  Â  Â  Â  Â   //æ—¶é—´æ›²çº¿ï¼Œæ…¢è¿›
UIViewAnimationOptionCurveEaseOutÂ  Â  Â  Â  Â  Â  Â  //æ—¶é—´æ›²çº¿ï¼Œæ…¢å‡º
UIViewAnimationOptionCurveLinearÂ  Â  Â  Â  Â  Â  Â   //æ—¶é—´æ›²çº¿ï¼ŒåŒ€é€Ÿ
UIViewAnimationOptionTransitionNoneÂ  Â  Â  Â  Â  Â  //è½¬åœºï¼Œä¸ä½¿ç”¨åŠ¨ç”»
UIViewAnimationOptionTransitionFlipFromLeftÂ  Â  //è½¬åœºï¼Œä»å·¦å‘å³æ—‹è½¬ç¿»é¡µ
UIViewAnimationOptionTransitionFlipFromRightÂ   //è½¬åœºï¼Œä»å³å‘å·¦æ—‹è½¬ç¿»é¡µ
UIViewAnimationOptionTransitionCurlUpÂ  Â  Â  Â  Â  //è½¬åœºï¼Œä¸‹å¾€ä¸Šå·æ›²ç¿»é¡µ
UIViewAnimationOptionTransitionCurlDownÂ  Â  Â  Â  //è½¬åœºï¼Œä»ä¸Šå¾€ä¸‹å·æ›²ç¿»é¡µ
UIViewAnimationOptionTransitionCrossDissolveÂ   //è½¬åœºï¼Œäº¤å‰æ¶ˆå¤±å’Œå‡ºç°
UIViewAnimationOptionTransitionFlipFromTopÂ  Â   //è½¬åœºï¼Œä»ä¸Šå‘ä¸‹æ—‹è½¬ç¿»é¡µ
UIViewAnimationOptionTransitionFlipFromBottomÂ  //è½¬åœºï¼Œä»ä¸‹å‘ä¸Šæ—‹è½¬ç¿»é¡µ
SpringåŠ¨ç”»ios7.0ä»¥åæ–°å¢äº†SpringåŠ¨ç”»(IOSç³»ç»ŸåŠ¨ç”»å¤§éƒ¨åˆ†é‡‡ç”¨Spring Animationï¼Œ é€‚ç”¨æ‰€æœ‰å¯è¢«æ·»åŠ åŠ¨ç”»æ•ˆæœçš„å±æ€§)
[UIView animateWithDuration:(NSTimeInterval)//åŠ¨ç”»æŒç»­æ—¶é—´
delay:(NSTimeInterval)//åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´
usingSpringWithDamping:(CGFloat)//éœ‡åŠ¨æ•ˆæœï¼ŒèŒƒå›´0~1ï¼Œæ•°å€¼è¶Šå°éœ‡åŠ¨æ•ˆæœè¶Šæ˜æ˜¾
initialSpringVelocity:(CGFloat)//åˆå§‹é€Ÿåº¦ï¼Œæ•°å€¼è¶Šå¤§åˆå§‹é€Ÿåº¦è¶Šå¿«
options:(UIViewAnimationOptions)//åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœ
animations:^{
//æ‰§è¡Œçš„åŠ¨ç”»
}
completion:^(BOOL finished) {
//åŠ¨ç”»æ‰§è¡Œæäº¤åçš„æ“ä½œ
}];
KeyframesåŠ¨ç”»
IOS7.0åæ–°å¢äº†å…³é”®å¸§åŠ¨ç”»ï¼Œæ”¯æŒå±æ€§å…³é”®å¸§ï¼Œä¸æ”¯æŒè·¯å¾„å…³é”®å¸§
[UIView animateKeyframesWithDuration:(NSTimeInterval)//åŠ¨ç”»æŒç»­æ—¶é—´
delay:(NSTimeInterval)//åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´
options:(UIViewKeyframeAnimationOptions)//åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœ
animations:^{
//æ‰§è¡Œçš„å…³é”®å¸§åŠ¨ç”»
}
completion:^(BOOL finished) {
//åŠ¨ç”»æ‰§è¡Œæäº¤åçš„æ“ä½œ
}];
UIViewKeyframeAnimationOptionsçš„æšä¸¾å€¼å¦‚ä¸‹ï¼Œå¯ç»„åˆä½¿ç”¨ï¼š
UIViewAnimationOptionLayoutSubviewsÂ  Â  Â  Â  Â   //è¿›è¡ŒåŠ¨ç”»æ—¶å¸ƒå±€å­æ§ä»¶
UIViewAnimationOptionAllowUserInteractionÂ  Â   //è¿›è¡ŒåŠ¨ç”»æ—¶å…è®¸ç”¨æˆ·äº¤äº’
UIViewAnimationOptionBeginFromCurrentStateÂ  Â  //ä»å½“å‰çŠ¶æ€å¼€å§‹åŠ¨ç”»
UIViewAnimationOptionRepeatÂ  Â  Â  Â  Â  Â  Â  Â  Â   //æ— é™é‡å¤æ‰§è¡ŒåŠ¨ç”»
UIViewAnimationOptionAutoreverseÂ  Â  Â  Â  Â  Â  Â  //æ‰§è¡ŒåŠ¨ç”»å›è·¯
UIViewAnimationOptionOverrideInheritedDuration //å¿½ç•¥åµŒå¥—åŠ¨ç”»çš„æ‰§è¡Œæ—¶é—´è®¾ç½®
UIViewAnimationOptionOverrideInheritedOptions //ä¸ç»§æ‰¿çˆ¶åŠ¨ç”»è®¾ç½®
UIViewKeyframeAnimationOptionCalculationModeLinearÂ  Â   //è¿ç®—æ¨¡å¼ :è¿ç»­
UIViewKeyframeAnimationOptionCalculationModeDiscreteÂ   //è¿ç®—æ¨¡å¼ :ç¦»æ•£
UIViewKeyframeAnimationOptionCalculationModePacedÂ  Â  Â  //è¿ç®—æ¨¡å¼ :å‡åŒ€æ‰§è¡Œ
UIViewKeyframeAnimationOptionCalculationModeCubicÂ  Â  Â  //è¿ç®—æ¨¡å¼ :å¹³æ»‘
UIViewKeyframeAnimationOptionCalculationModeCubicPaced //è¿ç®—æ¨¡å¼ :å¹³æ»‘å‡åŒ€
å„ç§è¿ç®—æ¨¡å¼çš„ç›´è§‚æ¯”è¾ƒå¦‚ä¸‹å›¾ï¼š
å¢åŠ å…³é”®å¸§æ–¹æ³•:
[UIView addKeyframeWithRelativeStartTime:(double)//åŠ¨ç”»å¼€å§‹çš„æ—¶é—´ï¼ˆå æ€»æ—¶é—´çš„æ¯”ä¾‹ï¼‰
relativeDuration:(double) //åŠ¨ç”»æŒç»­æ—¶é—´ï¼ˆå æ€»æ—¶é—´çš„æ¯”ä¾‹ï¼‰
animations:^{
//æ‰§è¡Œçš„åŠ¨ç”»
}];
è½¬åœºåŠ¨ç”»:a.ä»æ—§è§†å›¾åˆ°æ–°è§†å›¾çš„åŠ¨ç”»æ•ˆæœ
[UIView transitionFromView:(nonnull UIView *) toView:(nonnull UIView *) duration:(NSTimeInterval) options:(UIViewAnimationOptions) completion:^(BOOL finished) {
//åŠ¨ç”»æ‰§è¡Œæäº¤åçš„æ“ä½œ
}];
åœ¨è¯¥åŠ¨ç”»è¿‡ç¨‹ä¸­ï¼ŒfromView ä¼šä»çˆ¶è§†å›¾ä¸­ç§»é™¤ï¼Œå¹¶å°† toView æ·»åŠ åˆ°çˆ¶è§†å›¾ä¸­ï¼Œæ³¨æ„è½¬åœºåŠ¨ç”»çš„ä½œç”¨å¯¹è±¡æ˜¯çˆ¶è§†å›¾ï¼ˆè¿‡æ¸¡æ•ˆæœä½“ç°åœ¨çˆ¶è§†å›¾ä¸Šï¼‰ã€‚è°ƒç”¨è¯¥æ–¹æ³•ç›¸å½“äºæ‰§è¡Œä¸‹é¢ä¸¤å¥ä»£ç ï¼š
[fromView.superview addSubview:toView];
[fromView removeFromSuperview];
å•ä¸ªè§†å›¾çš„è¿‡æ¸¡æ•ˆæœ
[UIView transitionWithView:(nonnull UIView *)
duration:(NSTimeInterval)
options:(UIViewAnimationOptions)
animations:^{
//æ‰§è¡Œçš„åŠ¨ç”»
}
completion:^(BOOL finished) {
//åŠ¨ç”»æ‰§è¡Œæäº¤åçš„æ“ä½œ
}];
ä¸‹é¢ä¾æ—§ä¸¾ä¸¤ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
[UIView animateWithDuration:3.0 animations:^{
self.redView.center = point;
self.redView.transform = CGAffineTransformMakeScale(1.5, 1.5);
self.redView.transform = CGAffineTransformMakeRotation(M_PI);
} completion:^(BOOL finished) {
[UIView animateWithDuration:2.0 animations:^{
self.redView.frame = CGRectMake(100, 100, 100, 100);
self.redView.transform = CGAffineTransformMakeScale(1 / 1.5,1 / 1.5);
self.redView.transform = CGAffineTransformMakeRotation(M_PI);
}];
}];
ä»£ç å¦‚ä¸‹ï¼š
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
self.redView.alpha = 0;
/*
animateWithDuration åŠ¨ç”»æŒç»­æ—¶é—´
delay åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´
usingSpringWithDamping éœ‡åŠ¨æ•ˆæœï¼ŒèŒƒå›´0~1ï¼Œæ•°å€¼è¶Šå°éœ‡åŠ¨æ•ˆæœè¶Šæ˜æ˜¾
initialSpringVelocity åˆå§‹é€Ÿåº¦ï¼Œæ•°å€¼è¶Šå¤§åˆå§‹é€Ÿåº¦è¶Šå¿«
options åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœ
*/
[UIView animateWithDuration:3.0Â  delay:1.0 usingSpringWithDamping:0.3 initialSpringVelocity:1 options:UIViewAnimationOptionAllowUserInteraction animations:^{
self.redView.alpha = 1.0;
self.redView.frame = CGRectMake(200, 350, 140, 140);
} completion:^(BOOL finished) {
[self.redView removeFromSuperview];
}];
}
è¯´é“æ ¸å¿ƒåŠ¨ç”»ï¼Œé‚£å°±ä¸å¾—ä¸å…ˆè¯´ä¸‹CALayerã€‚
åœ¨iOSç³»ç»Ÿä¸­ï¼Œä½ èƒ½çœ‹å¾—è§æ‘¸å¾—ç€çš„ä¸œè¥¿åŸºæœ¬ä¸Šéƒ½æ˜¯UIViewï¼Œæ¯”å¦‚ä¸€ä¸ªæŒ‰é’®ã€ä¸€ä¸ªæ–‡æœ¬æ ‡ç­¾ã€ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ã€ä¸€ä¸ªå›¾æ ‡ç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯UIViewã€‚
å…¶å®UIViewä¹‹æ‰€ä»¥èƒ½æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œå®Œå…¨æ˜¯å› ä¸ºå®ƒå†…éƒ¨çš„ä¸€ä¸ªå±‚ã€‚
åœ¨åˆ›å»ºUIViewå¯¹è±¡æ—¶ï¼ŒUIViewå†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå±‚(å³CALayerå¯¹è±¡)ï¼Œé€šè¿‡UIViewçš„layerå±æ€§å¯ä»¥è®¿é—®è¿™ä¸ªå±‚ã€‚å½“UIViewéœ€è¦æ˜¾ç¤ºåˆ°å±å¹•ä¸Šæ—¶ï¼Œä¼šè°ƒç”¨drawRect:æ–¹æ³•è¿›è¡Œç»˜å›¾ï¼Œå¹¶ä¸”ä¼šå°†æ‰€æœ‰å†…å®¹ç»˜åˆ¶åœ¨è‡ªå·±çš„å±‚ä¸Šï¼Œç»˜å›¾å®Œæ¯•åï¼Œç³»ç»Ÿä¼šå°†å±‚æ‹·è´åˆ°å±å¹•ä¸Šï¼Œäºæ˜¯å°±å®Œæˆäº†UIViewçš„æ˜¾ç¤ºã€‚
æ¢å¥è¯è¯´ï¼ŒUIViewæœ¬èº«ä¸å…·å¤‡æ˜¾ç¤ºçš„åŠŸèƒ½ï¼Œæ˜¯å®ƒå†…éƒ¨çš„å±‚æ‰æœ‰æ˜¾ç¤ºåŠŸèƒ½ã€‚
ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼ŒUIViewä¹‹æ‰€ä»¥èƒ½å¤Ÿæ˜¾ç¤ºï¼Œå®Œå…¨æ˜¯å› ä¸ºå†…éƒ¨çš„CALayerå¯¹è±¡ã€‚å› æ­¤ï¼Œé€šè¿‡æ“ä½œè¿™ä¸ªCALayerå¯¹è±¡ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è°ƒæ•´UIViewçš„ä¸€äº›ç•Œé¢å±æ€§ï¼Œæ¯”å¦‚ï¼šé˜´å½±ã€åœ†è§’å¤§å°ã€è¾¹æ¡†å®½åº¦å’Œé¢œè‰²ç­‰ã€‚
//ä¸‹é¢æ˜¯CALayerçš„ä¸€äº›å±æ€§ä»‹ç»
//å®½åº¦å’Œé«˜åº¦
@property CGRect bounds;
//ä½ç½®(é»˜è®¤æŒ‡ä¸­ç‚¹ï¼Œå…·ä½“ç”±anchorPointå†³å®š)
@property CGPoint position;
//é”šç‚¹(x,yçš„èŒƒå›´éƒ½æ˜¯0-1)ï¼Œå†³å®šäº†positionçš„å«ä¹‰
@property CGPoint anchorPoint;
//èƒŒæ™¯é¢œè‰²(CGColorRefç±»å‹)
@propertyCGColorRefbackgroundColor;
//å½¢å˜å±æ€§
@property CATransform3D transform;
//è¾¹æ¡†é¢œè‰²(CGColorRefç±»å‹)
@propertyÂ  CGColorRefÂ  borderColor;
//è¾¹æ¡†å®½åº¦
@property CGFloat borderWidth;
//åœ†è§’åŠå¾„
@property CGFloat cornerRadius;
//å†…å®¹(æ¯”å¦‚è®¾ç½®ä¸ºå›¾ç‰‡CGImageRef)
@property(retain) id contents;
è¯´æ˜ï¼šå¯ä»¥é€šè¿‡è®¾ç½®contentså±æ€§ç»™UIViewè®¾ç½®èƒŒæ™¯å›¾ç‰‡,æ³¨æ„å¿…é¡»æ˜¯CGImageæ‰èƒ½æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨UIImageå¯¹è±¡åé¢åŠ ä¸Š.CGImageç›´æ¥è½¬æ¢ï¼Œè½¬æ¢ä¹‹åè¿˜éœ€è¦åœ¨å‰é¢åŠ ä¸Š(id)è¿›è¡Œå¼ºè½¬ã€‚
// è·¨æ¡†æ¶èµ‹å€¼éœ€è¦è¿›è¡Œæ¡¥æ¥
self.view.layer.contents = (__bridge id _Nullable)([UIImage imageNamed:@"123"].CGImage);
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒUIViewçš„CALayerå¯¹è±¡(å±‚)é€šè¿‡layerå±æ€§å¯ä»¥è®¿é—®è¿™ä¸ªå±‚ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé»˜è®¤çš„å±‚ä¸å…è®¸é‡æ–°åˆ›å»ºï¼Œä½†å¯ä»¥å¾€å±‚é‡Œé¢æ·»åŠ å­å±‚ã€‚UIViewå¯ä»¥é€šè¿‡addSubview:æ–¹æ³•æ·»åŠ å­è§†å›¾ï¼Œç±»ä¼¼åœ°ï¼ŒCALayerå¯ä»¥é€šè¿‡addSublayer:æ–¹æ³•æ·»åŠ å­å±‚
CALayerå¯¹è±¡æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§ï¼Œé‚£å°±æ˜¯positionå’ŒanchorPointã€‚
positionå’ŒanchorPointå±æ€§éƒ½æ˜¯CGPointç±»å‹çš„
positionå¯ä»¥ç”¨æ¥è®¾ç½®CALayeråœ¨çˆ¶å±‚ä¸­çš„ä½ç½®ï¼Œå®ƒæ˜¯ä»¥çˆ¶å±‚çš„å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹(0, 0)
anchorPointç§°ä¸º"å®šä½ç‚¹"ï¼Œå®ƒå†³å®šç€CALayerèº«ä¸Šçš„å“ªä¸ªç‚¹ä¼šåœ¨positionå±æ€§æ‰€æŒ‡çš„ä½ç½®ã€‚å®ƒçš„xã€yå–å€¼èŒƒå›´éƒ½æ˜¯0~1ï¼Œé»˜è®¤å€¼ä¸º(0.5, 0.5)
1.åˆ›å»ºä¸€ä¸ªCALayerï¼Œæ·»åŠ åˆ°æ§åˆ¶å™¨çš„viewçš„layerä¸­
CALayer *myLayer = [CALayer layer];
// è®¾ç½®å±‚çš„å®½åº¦å’Œé«˜åº¦ï¼ˆ100x100ï¼‰
myLayer.bounds = CGRectMake(0, 0, 100, 100);
// è®¾ç½®å±‚çš„ä½ç½®
myLayer.position = CGPointMake(100, 100);
// è®¾ç½®å±‚çš„èƒŒæ™¯é¢œè‰²ï¼šçº¢è‰²
myLayer.backgroundColor = [UIColor redColor].CGColor;
// æ·»åŠ myLayeråˆ°æ§åˆ¶å™¨çš„viewçš„layerä¸­
[self.view.layer addSublayer:myLayer];
ç¬¬5è¡Œè®¾ç½®äº†myLayerçš„positionä¸º(100, 100)ï¼Œåˆå› ä¸ºanchorPointé»˜è®¤æ˜¯(0.5, 0.5)ï¼Œæ‰€ä»¥æœ€åçš„æ•ˆæœæ˜¯ï¼šmyLayerçš„ä¸­ç‚¹ä¼šåœ¨çˆ¶å±‚çš„(100, 100)ä½ç½®
æ³¨æ„ï¼Œè“è‰²çº¿æ˜¯æˆ‘è‡ªå·±åŠ ä¸Šå»çš„ï¼Œæ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œå¹¶ä¸æ˜¯é»˜è®¤çš„æ˜¾ç¤ºæ•ˆæœã€‚ä¸¤æ¡è“è‰²çº¿çš„å®½åº¦å‡ä¸º100ã€‚
2.è‹¥å°†anchorPointæ”¹ä¸º(0, 0)ï¼ŒmyLayerçš„å·¦ä¸Šè§’ä¼šåœ¨(100, 100)ä½ç½®1 myLayer.anchorPoint = CGPointMake(0, 0);
3.è‹¥å°†anchorPointæ”¹ä¸º(1, 1)ï¼ŒmyLayerçš„å³ä¸‹è§’ä¼šåœ¨(100, 100)ä½ç½®1 myLayer.anchorPoint = CGPointMake(1, 1);
4.å°†anchorPointæ”¹ä¸º(0, 1)ï¼ŒmyLayerçš„å·¦ä¸‹è§’ä¼šåœ¨(100, 100)ä½ç½®1 myLayer.anchorPoint = CGPointMake(0, 1);
æˆ‘æƒ³ï¼Œä½ åº”è¯¥å·²ç»å¤§æ¦‚æ˜ç™½anchorPointçš„ç”¨é€”äº†å§ï¼Œå®ƒå†³å®šç€CALayerèº«ä¸Šçš„å“ªä¸ªç‚¹ä¼šåœ¨positionæ‰€æŒ‡å®šçš„ä½ç½®ä¸Šã€‚å®ƒçš„xã€yå–å€¼èŒƒå›´éƒ½æ˜¯0~1ï¼Œé»˜è®¤å€¼ä¸º(0.5, 0.5)ï¼Œå› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒCALayerçš„ä¸­ç‚¹ä¼šåœ¨positionæ‰€æŒ‡å®šçš„ä½ç½®ä¸Šã€‚å½“anchorPointä¸ºå…¶ä»–å€¼æ—¶ï¼Œä»¥æ­¤ç±»æ¨ã€‚
anchorPointæ˜¯è§†å›¾çš„ä¸­å¿ƒç‚¹ï¼Œpositionæ˜¯è§†å›¾çš„ä½ç½®ï¼Œä½ç½®ä¼šå’Œä¸­å¿ƒç‚¹é‡å ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å¼€å‘ä¸­å¯ä»¥é€šè¿‡ä¿®æ”¹è§†å›¾çš„layer.anchorPointæˆ–è€…layer.positionå®ç°ç‰¹å®šçš„åŠ¨ç”»æ•ˆæœã€‚
ä¸‹é¢ä¸¾ä¸ªä¸¤ä¸ªğŸŒ°
ä¸¤ä»½ä»£ç ï¼Œä¸Šé¢é‚£ä¸ªæ˜¯anchorPointä¸º(0.5, 0.5)ä¹Ÿå°±æ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸‹é¢é‚£ä¸ªæ˜¯(0, 0)ã€‚
ä»£ç å¦‚ä¸‹ï¼š
self.redView.layer.anchorPoint = CGPointMake(0.5, 0.5);
[UIView animateWithDuration:3.0 animations:^{
self.redView.transform = CGAffineTransformMakeRotation(M_PI);
} completion:^(BOOL finished) {
}];
ä»£ç å¦‚ä¸‹ï¼š
self.redView.layer.anchorPoint = CGPointMake(0, 0);
[UIView animateWithDuration:3.0 animations:^{
self.redView.transform = CGAffineTransformMakeRotation(M_PI);
} completion:^(BOOL finished) {
}];
æ ¹å±‚ä¸éæ ¹å±‚ï¼š
æ¯ä¸€ä¸ªUIViewå†…éƒ¨éƒ½é»˜è®¤å…³è”ç€ä¸€ä¸ªCALayerï¼Œæˆ‘ä»¬å¯ç”¨ç§°è¿™ä¸ªLayerä¸ºRoot Layerï¼ˆæ ¹å±‚ï¼‰
æ‰€æœ‰çš„éRoot Layerï¼Œä¹Ÿå°±æ˜¯æ‰‹åŠ¨åˆ›å»ºçš„CALayerå¯¹è±¡ï¼Œéƒ½å­˜åœ¨ç€éšå¼åŠ¨ç”»
å½“å¯¹éRoot Layerçš„éƒ¨åˆ†å±æ€§è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé»˜è®¤ä¼šè‡ªåŠ¨äº§ç”Ÿä¸€äº›åŠ¨ç”»æ•ˆæœï¼Œè€Œè¿™äº›å±æ€§ç§°ä¸ºAnimatable Properties(å¯åŠ¨ç”»å±æ€§)ã€‚
å¸¸è§çš„å‡ ä¸ªå¯åŠ¨ç”»å±æ€§ï¼š
boundsï¼šç”¨äºè®¾ç½®CALayerçš„å®½åº¦å’Œé«˜åº¦ã€‚ä¿®æ”¹è¿™ä¸ªå±æ€§ä¼šäº§ç”Ÿç¼©æ”¾åŠ¨ç”»
backgroundColorï¼šç”¨äºè®¾ç½®CALayerçš„èƒŒæ™¯è‰²ã€‚ä¿®æ”¹è¿™ä¸ªå±æ€§ä¼šäº§ç”ŸèƒŒæ™¯è‰²çš„æ¸å˜åŠ¨ç”»
positionï¼šç”¨äºè®¾ç½®CALayerçš„ä½ç½®ã€‚ä¿®æ”¹è¿™ä¸ªå±æ€§ä¼šäº§ç”Ÿå¹³ç§»åŠ¨ç”»
å¯ä»¥é€šè¿‡äº‹åŠ¡å…³é—­éšå¼åŠ¨ç”»ï¼š
[CATransaction begin];
// å…³é—­éšå¼åŠ¨ç”»
[CATransaction setDisableActions:YES];
self.myview.layer.position = CGPointMake(10, 10);
[CATransaction commit];
æ‰¯å¾—æœ‰ç‚¹è¿œäº†ï¼Œæˆ‘ä»¬ç»§ç»­å›åˆ°ä¸»é¢˜ï¼Œä¸‹é¢æ­£å¼ä»‹ç»æ ¸å¿ƒåŠ¨ç”»ã€‚
Core Animationï¼Œä¸­æ–‡ç¿»è¯‘ä¸ºæ ¸å¿ƒåŠ¨ç”»ï¼Œå®ƒæ˜¯ä¸€ç»„éå¸¸å¼ºå¤§çš„åŠ¨ç”»å¤„ç†APIï¼Œä½¿ç”¨å®ƒèƒ½åšå‡ºéå¸¸ç‚«ä¸½çš„åŠ¨ç”»æ•ˆæœï¼Œè€Œä¸”å¾€å¾€æ˜¯äº‹åŠåŠŸå€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨å°‘é‡çš„ä»£ç å°±å¯ä»¥å®ç°éå¸¸å¼ºå¤§çš„åŠŸèƒ½ã€‚
Core Animationå¯ä»¥ç”¨åœ¨Mac OS Xå’ŒiOSå¹³å°ã€‚
Core Animationçš„åŠ¨ç”»æ‰§è¡Œè¿‡ç¨‹éƒ½æ˜¯åœ¨åå°æ“ä½œçš„ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚
è¦æ³¨æ„çš„æ˜¯ï¼ŒCore Animationæ˜¯ç›´æ¥ä½œç”¨åœ¨CALayerä¸Šçš„ï¼Œå¹¶éUIViewã€‚
ä¹”å¸®ä¸»åœ¨2007å¹´çš„WWDCå¤§ä¼šä¸Šäº²è‡ªä¸ºä½ æ¼”ç¤ºCore Animationçš„å¼ºå¤§ï¼š
å¦‚æœæ˜¯xcode5ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä½¿ç”¨å®ƒéœ€è¦å…ˆæ·»åŠ QuartzCore.frameworkå’Œå¼•å…¥å¯¹åº”çš„æ¡†æ¶
å¼€å‘æ­¥éª¤:
1.ä½¿ç”¨å®ƒéœ€è¦å…ˆæ·»åŠ QuartzCore.frameworkæ¡†æ¶å’Œå¼•å…¥ä¸»å¤´æ–‡ä»¶
2.åˆå§‹åŒ–ä¸€ä¸ªCAAnimationå¯¹è±¡ï¼Œå¹¶è®¾ç½®ä¸€äº›åŠ¨ç”»ç›¸å…³å±æ€§
3.é€šè¿‡è°ƒç”¨CALayerçš„addAnimation:forKey:æ–¹æ³•å¢åŠ CAAnimationå¯¹è±¡åˆ°CALayerä¸­ï¼Œè¿™æ ·å°±èƒ½å¼€å§‹æ‰§è¡ŒåŠ¨ç”»äº†
4.é€šè¿‡è°ƒç”¨CALayerçš„removeAnimationForKey:æ–¹æ³•å¯ä»¥åœæ­¢CALayerä¸­çš„åŠ¨ç”»
æ˜¯æ‰€æœ‰åŠ¨ç”»å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æ§åˆ¶åŠ¨ç”»çš„æŒç»­æ—¶é—´å’Œé€Ÿåº¦ï¼Œæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨å®ƒå…·ä½“çš„å­ç±»å±æ€§è¯´æ˜ï¼š(å¸¦*å·ä»£è¡¨æ¥è‡ªCAMediaTimingåè®®çš„å±æ€§)
*durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´
*repeatCountï¼šé‡å¤æ¬¡æ•°ï¼Œæ— é™å¾ªç¯å¯ä»¥è®¾ç½®HUGE_VALFæˆ–è€…MAXFLOAT
*repeatDurationï¼šé‡å¤æ—¶é—´
removedOnCompletionï¼šé»˜è®¤ä¸ºYESï¼Œä»£è¡¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åå°±ä»å›¾å±‚ä¸Šç§»é™¤ï¼Œå›¾å½¢ä¼šæ¢å¤åˆ°åŠ¨ç”»æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚å¦‚æœæƒ³è®©å›¾å±‚ä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œåçš„çŠ¶æ€ï¼Œé‚£å°±è®¾ç½®ä¸ºNOï¼Œä¸è¿‡è¿˜è¦è®¾ç½®fillModeä¸ºkCAFillModeForwards
*fillModeï¼šå†³å®šå½“å‰å¯¹è±¡åœ¨éactiveæ—¶é—´æ®µçš„è¡Œä¸ºã€‚æ¯”å¦‚åŠ¨ç”»å¼€å§‹ä¹‹å‰æˆ–è€…åŠ¨ç”»ç»“æŸä¹‹å
*beginTimeï¼šå¯ä»¥ç”¨æ¥è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œæ—¶é—´ï¼Œè‹¥æƒ³å»¶è¿Ÿ2sï¼Œå°±è®¾ç½®ä¸ºCACurrentMediaTime()+2ï¼ŒCACurrentMediaTime()ä¸ºå›¾å±‚çš„å½“å‰æ—¶é—´
timingFunctionï¼šé€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥
delegateï¼šåŠ¨ç”»ä»£ç†
fillModeå±æ€§å€¼ï¼ˆè¦æƒ³fillModeæœ‰æ•ˆï¼Œæœ€å¥½è®¾ç½®removedOnCompletion = NOï¼‰
kCAFillModeRemoved è¿™ä¸ªæ˜¯é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´å½“åŠ¨ç”»å¼€å§‹å‰å’ŒåŠ¨ç”»ç»“æŸåï¼ŒåŠ¨ç”»å¯¹layeréƒ½æ²¡æœ‰å½±å“ï¼ŒåŠ¨ç”»ç»“æŸåï¼Œlayerä¼šæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€
kCAFillModeForwards å½“åŠ¨ç”»ç»“æŸåï¼Œlayerä¼šä¸€ç›´ä¿æŒç€åŠ¨ç”»æœ€åçš„çŠ¶æ€
kCAFillModeBackwards åœ¨åŠ¨ç”»å¼€å§‹å‰ï¼Œåªéœ€è¦å°†åŠ¨ç”»åŠ å…¥äº†ä¸€ä¸ªlayerï¼Œlayerä¾¿ç«‹å³è¿›å…¥åŠ¨ç”»çš„åˆå§‹çŠ¶æ€å¹¶ç­‰å¾…åŠ¨ç”»å¼€å§‹ã€‚
kCAFillModeBoth è¿™ä¸ªå…¶å®å°±æ˜¯ä¸Šé¢ä¸¤ä¸ªçš„åˆæˆ.åŠ¨ç”»åŠ å…¥åå¼€å§‹ä¹‹å‰ï¼Œlayerä¾¿å¤„äºåŠ¨ç”»åˆå§‹çŠ¶æ€ï¼ŒåŠ¨ç”»ç»“æŸålayerä¿æŒåŠ¨ç”»æœ€åçš„çŠ¶æ€
é€Ÿåº¦æ§åˆ¶å‡½æ•°(CAMediaTimingFunction)
kCAMediaTimingFunctionLinearï¼ˆçº¿æ€§ï¼‰ï¼šåŒ€é€Ÿï¼Œç»™ä½ ä¸€ä¸ªç›¸å¯¹é™æ€çš„æ„Ÿè§‰
kCAMediaTimingFunctionEaseInï¼ˆæ¸è¿›ï¼‰ï¼šåŠ¨ç”»ç¼“æ…¢è¿›å…¥ï¼Œç„¶ååŠ é€Ÿç¦»å¼€
kCAMediaTimingFunctionEaseOutï¼ˆæ¸å‡ºï¼‰ï¼šåŠ¨ç”»å…¨é€Ÿè¿›å…¥ï¼Œç„¶åå‡é€Ÿçš„åˆ°è¾¾ç›®çš„åœ°
kCAMediaTimingFunctionEaseInEaseOutï¼ˆæ¸è¿›æ¸å‡ºï¼‰ï¼šåŠ¨ç”»ç¼“æ…¢çš„è¿›å…¥ï¼Œä¸­é—´åŠ é€Ÿï¼Œç„¶åå‡é€Ÿçš„åˆ°è¾¾ç›®çš„åœ°ã€‚è¿™ä¸ªæ˜¯é»˜è®¤çš„åŠ¨ç”»è¡Œä¸ºã€‚
è®¾ç½®åŠ¨ç”»çš„æ‰§è¡ŒèŠ‚å¥anim.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
CAAnimationåœ¨åˆ†ç±»ä¸­å®šä¹‰äº†ä»£ç†æ–¹æ³•,æ˜¯ç»™NSObjectæ·»åŠ çš„åˆ†ç±»,æ‰€ä»¥ä»»ä½•å¯¹è±¡,æˆä¸ºCAAnimationçš„ä»£ç†éƒ½å¯ä»¥
@interface NSObject (CAAnimationDelegate)
/* Called when the animation begins its active duration. */
åŠ¨ç”»å¼€å§‹çš„æ—¶å€™è°ƒç”¨
- (void)animationDidStart:(CAAnimation *)anim;
åŠ¨ç”»åœæ­¢çš„æ—¶å€™è°ƒç”¨
- (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag;
@end
CALayerä¸ŠåŠ¨ç”»çš„æš‚åœå’Œæ¢å¤
#pragma mark æš‚åœCALayerçš„åŠ¨ç”»
-(void)pauseLayer:(CALayer*)layer
{
CFTimeInterval pausedTime = [layer convertTime:CACurrentMediaTime() fromLayer:nil];
è®©CALayerçš„æ—¶é—´åœæ­¢èµ°åŠ¨
layer.speed = 0.0;
è®©CALayerçš„æ—¶é—´åœç•™åœ¨pausedTimeè¿™ä¸ªæ—¶åˆ»
layer.timeOffset = pausedTime;
}
CALayerä¸ŠåŠ¨ç”»çš„æ¢å¤
#pragma mark æ¢å¤CALayerçš„åŠ¨ç”»
-(void)resumeLayer:(CALayer*)layer
{
CFTimeInterval pausedTime = layer.timeOffset;
1. è®©CALayerçš„æ—¶é—´ç»§ç»­è¡Œèµ°
layer.speed = 1.0;
2. å–æ¶ˆä¸Šæ¬¡è®°å½•çš„åœç•™æ—¶åˆ»
layer.timeOffset = 0.0;
3. å–æ¶ˆä¸Šæ¬¡è®¾ç½®çš„æ—¶é—´
layer.beginTime = 0.0;
4. è®¡ç®—æš‚åœçš„æ—¶é—´(è¿™é‡Œä¹Ÿå¯ä»¥ç”¨CACurrentMediaTime()-pausedTime)
CFTimeInterval timeSincePause = [layer convertTime:CACurrentMediaTime() fromLayer:nil] - pausedTime;
5. è®¾ç½®ç›¸å¯¹äºçˆ¶åæ ‡ç³»çš„å¼€å§‹æ—¶é—´(å¾€åé€€timeSincePause)
layer.beginTime = timeSincePause;
}
CAPropertyAnimation
æ˜¯CAAnimationçš„å­ç±»ï¼Œä¹Ÿæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œè¦æƒ³åˆ›å»ºåŠ¨ç”»å¯¹è±¡ï¼Œåº”è¯¥ä½¿ç”¨å®ƒçš„ä¸¤ä¸ªå­ç±»ï¼š
CABasicAnimation
CAKeyframeAnimation
å±æ€§è¯´æ˜ï¼škeyPathï¼šé€šè¿‡æŒ‡å®šCALayerçš„ä¸€ä¸ªå±æ€§åç§°ä¸ºkeyPathï¼ˆNSStringç±»å‹ï¼‰ï¼Œå¹¶ä¸”å¯¹CALayerçš„è¿™ä¸ªå±æ€§çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œè¾¾åˆ°ç›¸åº”çš„åŠ¨ç”»æ•ˆæœã€‚æ¯”å¦‚ï¼ŒæŒ‡å®š@â€œpositionâ€ä¸ºkeyPathï¼Œå°±ä¿®æ”¹CALayerçš„positionå±æ€§çš„å€¼ï¼Œä»¥è¾¾åˆ°å¹³ç§»çš„åŠ¨ç”»æ•ˆæœ
CABasicAnimationâ€”â€”åŸºæœ¬åŠ¨ç”»
åŸºæœ¬åŠ¨ç”»ï¼Œæ˜¯CAPropertyAnimationçš„å­ç±»
å±æ€§è¯´æ˜:keyPath:è¦æ”¹å˜çš„å±æ€§åç§°(ä¼ å­—ç¬¦ä¸²)
fromValueï¼škeyPathç›¸åº”å±æ€§çš„åˆå§‹å€¼
toValueï¼škeyPathç›¸åº”å±æ€§çš„ç»“æŸå€¼
åŠ¨ç”»è¿‡ç¨‹è¯´æ˜ï¼šéšç€åŠ¨ç”»çš„è¿›è¡Œï¼Œåœ¨é•¿åº¦ä¸ºdurationçš„æŒç»­æ—¶é—´å†…ï¼ŒkeyPathç›¸åº”å±æ€§çš„å€¼ä»fromValueæ¸æ¸åœ°å˜ä¸ºtoValue
keyPathå†…å®¹æ˜¯CALayerçš„å¯åŠ¨ç”»Animatableå±æ€§
å¦‚æœfillMode=kCAFillModeForwardsåŒæ—¶removedOnComletion=NOï¼Œé‚£ä¹ˆåœ¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åï¼Œå›¾å±‚ä¼šä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡Œåçš„çŠ¶æ€ã€‚ä½†åœ¨å®è´¨ä¸Šï¼Œå›¾å±‚çš„å±æ€§å€¼è¿˜æ˜¯åŠ¨ç”»æ‰§è¡Œå‰çš„åˆå§‹å€¼ï¼Œå¹¶æ²¡æœ‰çœŸæ­£è¢«æ”¹å˜ã€‚
//åˆ›å»ºåŠ¨ç”»
CABasicAnimation *anim = [CABasicAnimation animation];;
//Â  Â  è®¾ç½®åŠ¨ç”»å¯¹è±¡
keyPathå†³å®šäº†æ‰§è¡Œæ€æ ·çš„åŠ¨ç”»,è°ƒç”¨layerçš„å“ªä¸ªå±æ€§æ¥æ‰§è¡ŒåŠ¨ç”»
position:å¹³ç§»
anim.keyPath = @"position";
//Â  Â  åŒ…è£…æˆå¯¹è±¡
anim.fromValue = [NSValue valueWithCGPoint:CGPointMake(0, 0)];;
anim.toValue = [NSValue valueWithCGPoint:CGPointMake(200, 300)];
anim.duration = 2.0;
//Â  Â  è®©å›¾å±‚ä¿æŒåŠ¨ç”»æ‰§è¡Œå®Œæ¯•åçš„çŠ¶æ€
//Â  Â  æ‰§è¡Œå®Œæ¯•ä»¥åä¸è¦åˆ é™¤åŠ¨ç”»
anim.removedOnCompletion = NO;
//Â  Â  ä¿æŒæœ€æ–°çš„çŠ¶æ€
anim.fillMode = kCAFillModeForwards;
//Â  Â  æ·»åŠ åŠ¨ç”»
[self.layer addAnimation:anim forKey:nil];
ä¸¾ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
//åˆ›å»ºåŠ¨ç”»å¯¹è±¡
CABasicAnimation *anim = [CABasicAnimation animation];
//è®¾ç½®åŠ¨ç”»å±æ€§
anim.keyPath = @"position.y";
anim.toValue = @300;
//åŠ¨ç”»æäº¤æ—¶,ä¼šè‡ªåŠ¨åˆ é™¤åŠ¨ç”»
anim.removedOnCompletion = NO;
//è®¾ç½®åŠ¨ç”»æœ€åä¿æŒçŠ¶æ€
anim.fillMode = kCAFillModeForwards;
//æ·»åŠ åŠ¨ç”»å¯¹è±¡
[self.redView.layer addAnimation:anim forKey:nil];
å…³é”®å¸§åŠ¨ç”»ï¼Œä¹Ÿæ˜¯CAPropertyAnimationçš„å­ç±»ï¼Œä¸CABasicAnimationçš„åŒºåˆ«æ˜¯ï¼šCABasicAnimationåªèƒ½ä»ä¸€ä¸ªæ•°å€¼ï¼ˆfromValueï¼‰å˜åˆ°å¦ä¸€ä¸ªæ•°å€¼ï¼ˆtoValueï¼‰ï¼Œè€ŒCAKeyframeAnimationä¼šä½¿ç”¨ä¸€ä¸ªNSArrayä¿å­˜è¿™äº›æ•°å€¼
å±æ€§è¯´æ˜ï¼švaluesï¼šä¸Šè¿°çš„NSArrayå¯¹è±¡ã€‚é‡Œé¢çš„å…ƒç´ ç§°ä¸ºâ€œå…³é”®å¸§â€(keyframe)ã€‚åŠ¨ç”»å¯¹è±¡ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´ï¼ˆdurationï¼‰å†…ï¼Œä¾æ¬¡æ˜¾ç¤ºvaluesæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å¸§
pathï¼šä»£è¡¨è·¯å¾„å¯ä»¥è®¾ç½®ä¸€ä¸ªCGPathRefã€CGMutablePathRefï¼Œè®©å›¾å±‚æŒ‰ç…§è·¯å¾„è½¨è¿¹ç§»åŠ¨ã€‚pathåªå¯¹CALayerçš„
anchorPointå’Œpositionèµ·ä½œç”¨ã€‚å¦‚æœè®¾ç½®äº†pathï¼Œé‚£ä¹ˆvalueså°†è¢«å¿½ç•¥
keyTimesï¼šå¯ä»¥ä¸ºå¯¹åº”çš„å…³é”®å¸§æŒ‡å®šå¯¹åº”çš„æ—¶é—´ç‚¹ï¼Œå…¶å–å€¼èŒƒå›´ä¸º0åˆ°1.0ï¼ŒkeyTimesä¸­çš„æ¯ä¸€ä¸ªæ—¶é—´å€¼éƒ½å¯¹åº”valuesä¸­çš„æ¯ä¸€å¸§ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®keyTimesï¼Œå„ä¸ªå…³é”®å¸§çš„æ—¶é—´æ˜¯å¹³åˆ†çš„
CABasicAnimationå¯çœ‹åšæ˜¯åªæœ‰2ä¸ªå…³é”®å¸§çš„CAKeyframeAnimation
//Â  Â  åˆ›å»ºåŠ¨ç”»
CAKeyframeAnimation *anim = [CAKeyframeAnimation animation];;
//Â  Â  è®¾ç½®åŠ¨ç”»å¯¹è±¡
//Â  keyPathå†³å®šäº†æ‰§è¡Œæ€æ ·çš„åŠ¨ç”»,è°ƒæ•´å“ªä¸ªå±æ€§æ¥æ‰§è¡ŒåŠ¨ç”»
anim.keyPath = @"position";
NSValue *v1 = [NSValue valueWithCGPoint:CGPointMake(100, 0)];
NSValue *v2 = [NSValue valueWithCGPoint:CGPointMake(200, 0)];
NSValue *v3 = [NSValue valueWithCGPoint:CGPointMake(300, 0)];
NSValue *v4 = [NSValue valueWithCGPoint:CGPointMake(400, 0)];
anim.values = @[v1,v2,v3,v4];
anim.duration = 2.0;
//Â  Â  è®©å›¾å±‚ä¿æŒåŠ¨ç”»æ‰§è¡Œå®Œæ¯•åçš„çŠ¶æ€
//Â  Â  çŠ¶æ€æ‰§è¡Œå®Œæ¯•åä¸è¦åˆ é™¤åŠ¨ç”»
anim.removedOnCompletion = NO;
//Â  Â  ä¿æŒæœ€æ–°çš„çŠ¶æ€
anim.fillMode = kCAFillModeForwards;
//Â  Â  æ·»åŠ åŠ¨ç”»
[self.layer addAnimation:anim forKey:nil];
//Â  Â  æ ¹æ®è·¯å¾„åˆ›å»ºåŠ¨ç”»
//Â  Â  åˆ›å»ºåŠ¨ç”»
CAKeyframeAnimation *anim = [CAKeyframeAnimation animation];;
anim.keyPath = @"position";
anim.removedOnCompletion = NO;
anim.fillMode = kCAFillModeForwards;
anim.duration = 2.0;
//Â  Â  åˆ›å»ºä¸€ä¸ªè·¯å¾„
CGMutablePathRef path = CGPathCreateMutable();
//Â  Â  è·¯å¾„çš„èŒƒå›´
CGPathAddEllipseInRect(path, NULL, CGRectMake(100, 100, 200, 200));
//Â  Â  æ·»åŠ è·¯å¾„
anim.path = path;
//Â  Â  é‡Šæ”¾è·¯å¾„(å¸¦Createçš„å‡½æ•°åˆ›å»ºçš„å¯¹è±¡éƒ½éœ€è¦æ‰‹åŠ¨é‡Šæ”¾,å¦åˆ™ä¼šå†…å­˜æ³„éœ²)
CGPathRelease(path);
//Â  Â  æ·»åŠ åˆ°Viewçš„layer
[self.redView.layer addAnimation:anim forKey];
ä¸¾ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
//å¸§åŠ¨ç”»
CAKeyframeAnimation *anim = [CAKeyframeAnimation animation];
anim.keyPath = @"transform.rotation";
anim.values = @[@(angle2Radio(-5)),@(angle2Radio(5)),@(angle2Radio(-5))];
anim.repeatCount = MAXFLOAT;
//è‡ªåŠ¨åè½¬
//anim.autoreverses = YES;
[self.imageV.layer addAnimation:anim forKey:nil];
å†ä¸¾ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
#import "ViewController.h"
@interface ViewController ()
/** æ³¨é‡Š*/
@property (nonatomic ,weak) CALayer *fistLayer;
@property (strong, nonatomic)Â  NSMutableArray *imageArray;
@end
@implementation ViewController
- (void)viewDidLoad {
[super viewDidLoad];
//è®¾ç½®èƒŒæ™¯
self.view.layer.contents = (id)[UIImage imageNamed:@"bg"].CGImage;
CALayer *fistLayer = [CALayer layer];
fistLayer.frame = CGRectMake(100, 288, 89, 40);
//fistLayer.backgroundColor = [UIColor redColor].CGColor;
[self.view.layer addSublayer:fistLayer];
self.fistLayer = fistLayer;
//fistLayer.transform = CATransform3DMakeRotation(M_PI, 0, 0, 1);
//åŠ è½½å›¾ç‰‡
NSMutableArray *imageArray = [NSMutableArray array];
for (int i = 0; i < 10; i++) {
UIImage *image = [UIImage imageNamed:[NSString stringWithFormat:@"fish%d",i]];
[imageArray addObject:image];
}
self.imageArray = imageArray;
//æ·»åŠ å®šæ—¶å™¨
[NSTimer scheduledTimerWithTimeInterval:0.1 target:self selector:@selector(update) userInfo:nil repeats:YES];
//æ·»åŠ åŠ¨ç”»
CAKeyframeAnimation *anim = [CAKeyframeAnimation animation];
anim.keyPath = @"position";
UIBezierPath *path = [UIBezierPath bezierPath];
[path moveToPoint:CGPointMake(100, 200)];
[path addLineToPoint:CGPointMake(350, 200)];
[path addLineToPoint:CGPointMake(350, 500)];
[path addQuadCurveToPoint:CGPointMake(100, 200) controlPoint:CGPointMake(150, 700)];
//ä¼ å…¥è·¯å¾„
anim.path = path.CGPath;
anim.durationÂ  = 5;
anim.repeatCount = MAXFLOAT;
anim.calculationMode = @"cubicPaced";
anim.rotationMode = @"autoReverse";
[fistLayer addAnimation:anim forKey:nil];
}
static int _imageIndex = 0;
- (void)update {
//ä»æ•°ç»„å½“ä¸­å–å‡ºå›¾ç‰‡
UIImage *image = self.imageArray[_imageIndex];
self.fistLayer.contents = (id)image.CGImage;
_imageIndex++;
if (_imageIndex > 9) {
_imageIndex = 0;
}
}
@end
CATransitionæ˜¯CAAnimationçš„å­ç±»ï¼Œç”¨äºåšè½¬åœºåŠ¨ç”»ï¼Œèƒ½å¤Ÿä¸ºå±‚æä¾›ç§»å‡ºå±å¹•å’Œç§»å…¥å±å¹•çš„åŠ¨ç”»æ•ˆæœã€‚iOSæ¯”Mac OS Xçš„è½¬åœºåŠ¨ç”»æ•ˆæœå°‘ä¸€ç‚¹
UINavigationControllerå°±æ˜¯é€šè¿‡CATransitionå®ç°äº†å°†æ§åˆ¶å™¨çš„è§†å›¾æ¨å…¥å±å¹•çš„åŠ¨ç”»æ•ˆæœ
åŠ¨ç”»å±æ€§:(æœ‰çš„å±æ€§æ˜¯å…·å¤‡æ–¹å‘çš„,è¯¦æƒ…çœ‹ä¸‹å›¾)
typeï¼šåŠ¨ç”»è¿‡æ¸¡ç±»å‹
subtypeï¼šåŠ¨ç”»è¿‡æ¸¡æ–¹å‘
startProgressï¼šåŠ¨ç”»èµ·ç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)
endProgressï¼šåŠ¨ç”»ç»ˆç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)
CATransition *anim = [CATransition animation];
è½¬åœºç±»å‹
anim.type = @"cube";
åŠ¨ç”»æ‰§è¡Œæ—¶é—´
anim.duration = 0.5;
åŠ¨ç”»æ‰§è¡Œæ–¹å‘
anim.subtype = kCATransitionFromLeft;
æ·»åŠ åˆ°Viewçš„layer
[self.redView.layer addAnimation:anim forKey];
ä¸¾ä¸ªğŸŒ°ï¼š
#import "ViewController.h"
@interface ViewController ()
@property (weak, nonatomic) IBOutlet UIImageView *imageV;
@end
@implementation ViewController
- (void)viewDidLoad {
[super viewDidLoad];
self.imageV.userInteractionEnabled = YES;
//æ·»åŠ æ‰‹åŠ¿
UISwipeGestureRecognizer *leftSwipe = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipe:)];
leftSwipe.direction = UISwipeGestureRecognizerDirectionLeft;
[self.imageV addGestureRecognizer:leftSwipe];
UISwipeGestureRecognizer *rightSwipe = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipe:)];
rightSwipe.direction = UISwipeGestureRecognizerDirectionRight;
[self.imageV addGestureRecognizer:rightSwipe];
}
static int _imageIndex = 0;
- (void)swipe:(UISwipeGestureRecognizer *)swipe {
//è½¬åœºä»£ç ä¸è½¬åœºåŠ¨ç”»å¿…é¡»å¾—åœ¨åŒä¸€ä¸ªæ–¹æ³•å½“ä¸­.
NSString *dir = nil;
if (swipe.direction == UISwipeGestureRecognizerDirectionLeft) {
_imageIndex++;
if (_imageIndex > 4) {
_imageIndex = 0;
}
NSString *imageName = [NSString stringWithFormat:@"%d",_imageIndex];
self.imageV.image = [UIImage imageNamed:imageName];
dir = @"fromRight";
}else if (swipe.direction == UISwipeGestureRecognizerDirectionRight) {
_imageIndex--;
if (_imageIndex < 0) {
_imageIndex = 4;
}
NSString *imageName = [NSString stringWithFormat:@"%d",_imageIndex];
self.imageV.image = [UIImage imageNamed:imageName];
dir = @"fromLeft";
}
//æ·»åŠ åŠ¨ç”»
CATransition *anim = [CATransition animation];
//è®¾ç½®è½¬åœºç±»å‹
anim.type = @"cube";
//è®¾ç½®è½¬åœºçš„æ–¹å‘
anim.subtype = dir;
anim.duration = 0.5;
//åŠ¨ç”»ä»å“ªä¸ªç‚¹å¼€å§‹
//Â  Â  anim.startProgress = 0.2;
//Â  Â  anim.endProgress = 0.3;
[self.imageV.layer addAnimation:anim forKey:nil];
}
- (void)didReceiveMemoryWarning {
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}
@end
åŠ¨ç”»ç»„ï¼Œæ˜¯CAAnimationçš„å­ç±»ï¼Œå¯ä»¥ä¿å­˜ä¸€ç»„åŠ¨ç”»å¯¹è±¡ï¼Œå°†CAAnimationGroupå¯¹è±¡åŠ å…¥å±‚åï¼Œç»„ä¸­æ‰€æœ‰åŠ¨ç”»å¯¹è±¡å¯ä»¥åŒæ—¶å¹¶å‘è¿è¡Œ
å±æ€§è¯´æ˜ï¼š
animationsï¼šç”¨æ¥ä¿å­˜ä¸€ç»„åŠ¨ç”»å¯¹è±¡çš„NSArray
é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ç»„åŠ¨ç”»å¯¹è±¡æ˜¯åŒæ—¶è¿è¡Œçš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®åŠ¨ç”»å¯¹è±¡çš„beginTimeå±æ€§æ¥æ›´æ”¹åŠ¨ç”»çš„å¼€å§‹æ—¶é—´
CAAnimationGroup *group = [CAAnimationGroup animation];
//Â  Â  åˆ›å»ºæ—‹è½¬åŠ¨ç”»å¯¹è±¡
CABasicAnimation *retate = [CABasicAnimation animation];
//Â  Â  layerçš„æ—‹è½¬å±æ€§
retate.keyPath = @"transform.rotation";
//Â  Â  è§’åº¦
retate.toValue = @(M_PI);
//Â  Â  åˆ›å»ºç¼©æ”¾åŠ¨ç”»å¯¹è±¡
CABasicAnimation *scale = [CABasicAnimation animation];
//Â  Â  ç¼©æ”¾å±æ€§
scale.keyPath = @"transform.scale";
//Â  Â  ç¼©æ”¾æ¯”ä¾‹
scale.toValue = @(0.0);
//Â  Â  æ·»åŠ åˆ°åŠ¨ç”»ç»„å½“ä¸­
group.animations = @[retate,scale];
//Â  Â  Â  Â  Â   æ‰§è¡ŒåŠ¨ç”»æ—¶é—´
group.duration = 2.0;
//Â  Â  æ‰§è¡Œå®Œä»¥åä¸è¦åˆ é™¤åŠ¨ç”»
group.removedOnCompletion = NO;
//Â  Â  Â  Â  Â  ä¿æŒæœ€æ–°çš„çŠ¶æ€
group.fillMode = kCAFillModeForwards;
[self.view.layer addAnimation:group forKey:nil];
ä¸¾ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
#import "ViewController.h"
@interface ViewController ()
@property (weak, nonatomic) IBOutlet UIView *redView;
@end
@implementation ViewController
- (void)viewDidLoad {
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
//ç§»åŠ¨
CABasicAnimation *anim = [CABasicAnimation animation];
anim.keyPath =Â  @"position.y";
anim.toValue = @500;
//Â  Â  anim.removedOnCompletion = NO;
//Â  Â  anim.fillMode = kCAFillModeForwards;
//Â  Â  [self.redView.layer addAnimation:anim forKey:nil];
//
//ç¼©æ”¾
CABasicAnimation *anim2 = [CABasicAnimation animation];
anim2.keyPath =Â  @"transform.scale";
anim2.toValue = @0.5;
//Â  Â  anim2.removedOnCompletion = NO;
//Â  Â  anim2.fillMode = kCAFillModeForwards;
//Â  Â  [self.redView.layer addAnimation:anim2 forKey:nil];
CAAnimationGroup *groupAnim = [CAAnimationGroup animation];
//ä¼šæ‰§è¡Œæ•°ç»„å½“ä¸­æ¯ä¸€ä¸ªåŠ¨ç”»å¯¹è±¡
groupAnim.animations = @[anim,anim2];
groupAnim.removedOnCompletion = NO;
groupAnim.fillMode = kCAFillModeForwards;
[self.redView.layer addAnimation:groupAnim forKey:nil];
}
- (void)didReceiveMemoryWarning {
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}
@end
ä¸‰å¤§åŠ¨ç”»:(ä¸éœ€è¦äº¤äº’çš„æ—¶å€™å¯ä»¥é€‰æ‹©ä»¥ä¸‹åŠ¨ç”»)
CAAnimationGroupâ€”â€”åŠ¨ç”»ç»„
CAKeyframeAnimationâ€”â€”å…³é”®å¸§åŠ¨ç”»
è½¬åœºåŠ¨ç”»â€”â€”CATransition
ä½¿ç”¨UIViewåŠ¨ç”»å‡½æ•°å®ç°è½¬åœºåŠ¨ç”»â€”â€”å•è§†å›¾
//å‚æ•°è¯´æ˜ï¼š
durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´
viewï¼šéœ€è¦è¿›è¡Œè½¬åœºåŠ¨ç”»çš„è§†å›¾
optionsï¼šè½¬åœºåŠ¨ç”»çš„ç±»å‹
animationsï¼šå°†æ”¹å˜è§†å›¾å±æ€§çš„ä»£ç æ”¾åœ¨è¿™ä¸ªblockä¸­
completionï¼šåŠ¨ç”»ç»“æŸåï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªblock
+ (void)transitionWithView:(UIView *)view duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion;
å‚æ•°è¯´æ˜ï¼š
durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´
optionsï¼šè½¬åœºåŠ¨ç”»çš„ç±»å‹
animationsï¼šå°†æ”¹å˜è§†å›¾å±æ€§çš„ä»£ç æ”¾åœ¨è¿™ä¸ªblockä¸­
completionï¼šåŠ¨ç”»ç»“æŸåï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªblock
+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^)(BOOL finished))completion;
1.åˆ›å»ºè½¬åœºåŠ¨ç”»:[CATransition animation];
2.è®¾ç½®åŠ¨ç”»å±æ€§å€¼
3.æ·»åŠ åˆ°éœ€è¦ä¸“åœºåŠ¨ç”»çš„å›¾å±‚ä¸Š [ layer addAimation:animation forKer:nil];
è½¬åœºåŠ¨ç”»çš„ç±»å‹ï¼ˆNSString *typeï¼‰
fade : äº¤å‰æ·¡åŒ–è¿‡æ¸¡
push : æ–°è§†å›¾æŠŠæ—§è§†å›¾æ¨å‡ºå»
moveIn: æ–°è§†å›¾ç§»åˆ°æ—§è§†å›¾ä¸Šé¢
reveal: å°†æ—§è§†å›¾ç§»å¼€,æ˜¾ç¤ºä¸‹é¢çš„æ–°è§†å›¾
cube : ç«‹æ–¹ä½“ç¿»æ»šæ•ˆæœ
oglFlip : ä¸Šä¸‹å·¦å³ç¿»è½¬æ•ˆæœ
suckEffect : æ”¶ç¼©æ•ˆæœï¼Œå¦‚ä¸€å—å¸ƒè¢«æŠ½èµ°
rippleEffect: æ°´æ»´æ•ˆæœ
pageCurl : å‘ä¸Šç¿»é¡µæ•ˆæœ
pageUnCurl : å‘ä¸‹ç¿»é¡µæ•ˆæœ
cameraIrisHollowOpen : ç›¸æœºé•œå¤´æ‰“å¼€æ•ˆæœ
cameraIrisHollowClos : ç›¸æœºé•œå¤´å…³é—­æ•ˆæœ
æ³¨æ„ï¼šæ ¸å¿ƒåŠ¨ç”»åªæ˜¯ä¿®æ”¹äº†æ§ä»¶çš„å›¾å½¢æ ‘ï¼Œæ¢å¥è¯è¯´å°±æ˜¯åªæ˜¯ä¿®æ”¹äº†ä»–çš„æ˜¾ç¤ºï¼Œå¹¶æ²¡æœ‰æ”¹å˜æ§ä»¶çš„çœŸå®ä½ç½®ï¼ï¼ï¼ä¹Ÿå°±æ˜¯è¯´åœ¨åŠ¨ç”»çš„è¿‡ç¨‹ä¸­ç‚¹å‡»æ§ä»¶æ˜¯ä¸èƒ½è·Ÿç”¨æˆ·è¿›è¡Œäº¤äº’çš„ï¼Œåˆ‡è®°åˆ‡è®°ï¼ï¼ï¼å½“ç„¶ï¼Œç‚¹å‡»æ§ä»¶çš„èµ·å§‹ä½ç½®æ˜¯å¯ä»¥çš„ã€‚
è¿™é‡Œè®²çš„å¸§åŠ¨ç”»æ˜¯æŒ‡UIIMageViewè‡ªå¸¦çš„åŠ¨ç”»ã€‚é¡ºå¸¦è·Ÿå¤§å®¶è®²ä¸‹æ€ä¹ˆå°†ä¸€ä¸ªgitåŠ¨æ€å›¾é‡Œé¢çš„å›¾ç‰‡å–å‡ºæ¥ï¼Œå¹¶åŠ ä»¥æ˜¾ç¤ºã€‚åŠ¨ç”»å±æ€§ï¼š
@property (nonatomic) NSTimeInterval animationDuration;Â  Â  Â  Â   // for one cycle of images. default is number of images * 1/30th of a second (i.e. 30 fps)
@property (nonatomic) NSIntegerÂ  Â  Â  animationRepeatCount;Â  Â  Â  // 0 means infinite (default is 0)
ä¸¾ä¸ªğŸŒ°ï¼š
ä»£ç å¦‚ä¸‹ï¼š
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
NSArray *imageArray = [self getImageArrayWithGIFNameWit:@"aisi"];
self.imageView.animationImages = imageArray;
self.imageView.animationDuration = 3;
self.imageView.animationRepeatCount = MAXFLOAT;
[self.imageView startAnimating];
dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(5.0 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{
[_imageView stopAnimating];
});
}
- (NSArray *)getImageArrayWithGIFNameWit:(NSString *)imageName {
NSMutableArray *imageArray = [NSMutableArray array];
NSString *path = [[NSBundle mainBundle] pathForResource:imageName ofType:@"gif"];
NSData *data = [NSData dataWithContentsOfFile:path];
if (!data) {
NSLog(@"å›¾ç‰‡ä¸å­˜åœ¨!");
return nil;
}
CGImageSourceRef source = CGImageSourceCreateWithData((__bridge CFDataRef)data, NULL);
size_t count = CGImageSourceGetCount(source);
if (count <= 1) {
[imageArray addObject:[[UIImage alloc] initWithData:data]];
}else {
for (size_t i = 0; i < count; i++) {
CGImageRef image = CGImageSourceCreateImageAtIndex(source, i, NULL);
[imageArray addObject:[UIImage imageWithCGImage:image scale:[UIScreen mainScreen].scale orientation:UIImageOrientationUp]];
CGImageRelease(image);
}
}
CFRelease(source);
return imageArray;
}